// import labs/block2/arith/infix;

/* 
	s2re - string to rpn expression
	ie2re - infix expression to rpn expression
*/

export {
	s2re(s: string) -> [RpnExpr];
	ie2re(e : InfixExpr) -> [RpnExpr];
}

s2re(s: string) {
	parsic(postfixGrammar, s, defaultPegActions);
}

ie2re(ie : InfixExpr) -> [RpnExpr] {
	re : [RpnExpr] = [];
	ie2reReqursive(ie, re);
}

ie2reReqursive(ie : InfixExpr, re : [RpnExpr]) -> [RpnExpr] {
	switch(ie) {
		Const(c): arrayPush(re, Const(c));
		BinOp(name, l, r): {
			a = ie2reReqursive(l, re);
			b = ie2reReqursive(r, a);
			arrayPush(b, OpName(name));
		}
	}
}