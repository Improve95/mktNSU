import exprDecl;

export {
  //lab6
  re2ie(expr : [RpnExpr]) -> InfixExpr;
}

re2ie(expr : [RpnExpr]) -> InfixExpr {
  stack : [InfixExpr] = [];

	a = fold(expr, stack, \st, val -> {
		switch (val) {
			Const(c):
				arrayPush(st, Const(c));

			/* Var(v):
				arrayPush(st, Var(v)); */

			OpName(name): {
				right = lastElement(st, Const(0));
				a = removeIndex(st, length(st) - 1);
				left = lastElement(a, Const(0));
				b = removeIndex(a, length(a) - 1);
				arrayPush(b, BinOp(name, left, right));
			}
    
		}
	});

	a[0];
}