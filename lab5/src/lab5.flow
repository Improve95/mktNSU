import string;
import math/math;
import ds/tree;
import lingo/pegcode/driver;
import fs/filesystem;

grammar = compilePegGrammar("#include exprParser.lingo");

Expr ::= Sum, Mul, Int;
  Int(i : int);
  Sum(e1 : Expr, e2 : Expr);
  Mul(e1 : Expr, e2 : Expr);

ex2i(e : Expr) -> int {
  switch (e) {
    Int(i): i;
    Sum(e1, e2): ex2i(e1) + ex2i(e2);
    Mul(e1, e2): ex2i(e1) * ex2i(e2);
  }
}

calculate(s : string) -> int {
  expr = parsic(grammar, s, defaultPegActions);
  ex2i(expr)
}

main() {
  expr = "2*(5+5)+30";
  println(calculate(expr));
  quit(0);
}
