import string;
import math/math;
import ds/tree;
import lingo/pegcode/driver;
import fs/filesystem;

export {
  ArExpr ::= ArInt;
    ArInt(val : int);

  ar2s(e : ArExpr) -> string {
    switch (e) {
      ArInt(val): i2s(val);
    }
  }

  ar2i(e : ArExpr) -> int {
    switch (e) {
      ArInt(val): val;
    }
  }

  s2ar(str : string) -> ArExpr {
    parsic(
      compilePegGrammar("#include exprParser.lingo"),
      str, 
      SemanticActions(setTree(defaultPegActions.t, "createArInt", \s -> ArInt(s2i(s[0]))))
    )
  }
}

main() {
  expr = "5";

  res : ArExpr = s2ar(expr);
  // println(res);

  quit(0);
}
